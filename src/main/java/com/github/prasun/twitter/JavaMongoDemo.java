package com.github.prasun.twitter;

import com.mongodb.MongoClient;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import org.bson.Document;
import org.bson.types.ObjectId;

import java.util.Arrays;
import java.util.Random;

public class JavaMongoDemo {
    public static void main(String[] args){
        Random rand = new Random();
        MongoClient mongoClient = new MongoClient( "localhost" , 27017 );
        MongoDatabase db = mongoClient.getDatabase("friends");
        MongoCollection<Document> studentCollection = db.getCollection("tweets");
        Document student = new Document("_id", new ObjectId());
//        {"created_at":"Thu Sep 03 15:05:34 +0000 2020","id":1301536823303233543,"id_str":"1301536823303233543","text":"RT @sdhr1192s: APEX\u3068\u80a9\u3092\u4e26\u3079\u308b\u30ab\u30cb\u306e\u30d0\u30c8\u30ed\u30ef\u3067\u4e16\u754c1\u4f4d\u306b\u306a\u308a\u307e\u3057\u305f\u3002 - king of crabs https:\/\/t.co\/BWGwQsBWSE \n\nAPEX\u3084PUBG\u3088\u308a\u304d\u3066\u308b\u307b\u3093\u3068\u306b(\u7b11)\n\u305d\u308c\u3068\u3001\u4eca\u304b\u3089\u30b3\u30e1\u3044\u3044\u306d\u3057\u306b\u3044\u304f\u3088\uff01","source":"\u003ca href=\"http:\/\/twitter.com\/download\/iphone\" rel=\"nofollow\"\u003eTwitter for iPhone\u003c\/a\u003e","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":1085318923447226369,"id_str":"1085318923447226369","name":"\u672a \u8587 \u4f0a","screen_name":"00o315","location":"\u9aa8\ud83d\udc3f","url":null,"description":"\u30db\u30e9\u30b2\u5b9f\u6cc1\u3059\u3053 \u201c@sdhr1192\u201d","translator_type":"none","protected":false,"verified":false,"followers_count":19,"friends_count":77,"listed_count":0,"favourites_count":8501,"statuses_count":2954,"created_at":"Tue Jan 15 23:32:50 +0000 2019","utc_offset":null,"time_zone":null,"geo_enabled":false,"lang":null,"contributors_enabled":false,"is_translator":false,"profile_background_color":"F5F8FA","profile_background_image_url":"","profile_background_image_url_https":"","profile_background_tile":false,"profile_link_color":"1DA1F2","profile_sidebar_border_color":"C0DEED","profile_sidebar_fill_color":"DDEEF6","profile_text_color":"333333","profile_use_background_image":true,"profile_image_url":"http:\/\/pbs.twimg.com\/profile_images\/1225827961594531843\/SOACfXpX_normal.jpg","profile_image_url_https":"https:\/\/pbs.twimg.com\/profile_images\/1225827961594531843\/SOACfXpX_normal.jpg","profile_banner_url":"https:\/\/pbs.twimg.com\/profile_banners\/1085318923447226369\/1590496095","default_profile":true,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"retweeted_status":{"created_at":"Wed Aug 26 10:45:28 +0000 2020","id":1298572261763383297,"id_str":"1298572261763383297","text":"APEX\u3068\u80a9\u3092\u4e26\u3079\u308b\u30ab\u30cb\u306e\u30d0\u30c8\u30ed\u30ef\u3067\u4e16\u754c1\u4f4d\u306b\u306a\u308a\u307e\u3057\u305f\u3002 - king of crabs https:\/\/t.co\/BWGwQsBWSE \n\nAPEX\u3084PUBG\u3088\u308a\u304d\u3066\u308b\u307b\u3093\u3068\u306b(\u7b11)\n\u305d\u308c\u3068\u3001\u4eca\u304b\u3089\u30b3\u30e1\u3044\u3044\u306d\u3057\u306b\u3044\u304f\u3088\uff01","source":"\u003ca href=\"https:\/\/mobile.twitter.com\" rel=\"nofollow\"\u003eTwitter Web App\u003c\/a\u003e","truncated":false,"in_reply_to_status_id":null,"in_reply_to_status_id_str":null,"in_reply_to_user_id":null,"in_reply_to_user_id_str":null,"in_reply_to_screen_name":null,"user":{"id":782053544220237824,"id_str":"782053544220237824","name":"\u3055\u3060\u306f\u308b(2).jpg","screen_name":"sdhr1192s","location":null,"url":null,"description":"@sdhr1192 \u306e\u30b5\u30d6\u57a2 \/ #\u3055\u3060\u7d75 \/ \u65e5\u5e38 @sdhr1192ss https:\/\/www.amazon.jp\/hz\/wishlist\/ls\/3TQ7HIIFK0XPY?ref_=wl_share","translator_type":"none","protected":false,"verified":false,"followers_count":23635,"friends_count":18194,"listed_count":153,"favourites_count":110034,"statuses_count":22187,"created_at":"Sat Oct 01 03:04:29 +0000 2016","utc_offset":null,"time_zone":null,"geo_enabled":false,"lang":null,"contributors_enabled":false,"is_translator":false,"profile_background_color":"F5F8FA","profile_background_image_url":"","profile_background_image_url_https":"","profile_background_tile":false,"profile_link_color":"1DA1F2","profile_sidebar_border_color":"C0DEED","profile_sidebar_fill_color":"DDEEF6","profile_text_color":"333333","profile_use_background_image":true,"profile_image_url":"http:\/\/pbs.twimg.com\/profile_images\/1241246064247574529\/ESQhw0M8_normal.jpg","profile_image_url_https":"https:\/\/pbs.twimg.com\/profile_images\/1241246064247574529\/ESQhw0M8_normal.jpg","profile_banner_url":"https:\/\/pbs.twimg.com\/profile_banners\/782053544220237824\/1577156404","default_profile":true,"default_profile_image":false,"following":null,"follow_request_sent":null,"notifications":null},"geo":null,"coordinates":null,"place":null,"contributors":null,"is_quote_status":false,"quote_count":6,"reply_count":80,"retweet_count":121,"favorite_count":755,"entities":{"hashtags":[],"urls":[{"url":"https:\/\/t.co\/BWGwQsBWSE","expanded_url":"https:\/\/youtu.be\/TFMdxu8VZyc","display_url":"youtu.be\/TFMdxu8VZyc","indices":[46,69]}],"user_mentions":[],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"low","lang":"ja"},"is_quote_status":false,"quote_count":0,"reply_count":0,"retweet_count":0,"favorite_count":0,"entities":{"hashtags":[],"urls":[{"url":"https:\/\/t.co\/BWGwQsBWSE","expanded_url":"https:\/\/youtu.be\/TFMdxu8VZyc","display_url":"youtu.be\/TFMdxu8VZyc","indices":[61,84]}],"user_mentions":[{"screen_name":"sdhr1192s","name":"\u3055\u3060\u306f\u308b(2).jpg","id":782053544220237824,"id_str":"782053544220237824","indices":[3,13]}],"symbols":[]},"favorited":false,"retweeted":false,"possibly_sensitive":false,"filter_level":"low","lang":"ja","timestamp_ms":"1599145534717"}
        student.append("student_id", 10000d)
                .append("class_id", 1d)
                .append("scores", Arrays.asList(new Document("type", "exam").append("score", rand.nextDouble() * 100),
                        new Document("type", "quiz").append("score", rand.nextDouble() * 100),
                        new Document("type", "homework").append("score", rand.nextDouble() * 100),
                        new Document("type", "homework").append("score", rand.nextDouble() * 100)));
        studentCollection.insertOne(student);
    }
}
